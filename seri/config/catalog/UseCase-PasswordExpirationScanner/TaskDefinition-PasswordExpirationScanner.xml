<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE TaskDefinition PUBLIC "sailpoint.dtd" "sailpoint.dtd">
<TaskDefinition executor="sailpoint.seri.task.PasswordExpirationScanner"
  name="Password Expiration Scanner" type="Generic" template="true">
  <Description>
    IdentityIQ Password Expiration Scanner -- Scans Active Directory for passwords
    about to expire and notifies the users
  </Description>
  <Attributes>
    <Map>
      <entry key="expiringEmailTemplate" value="Password Expiration Notification-HTML" />
      <entry key="expiredEmailTemplate" value="Password Expired Notification-HTML" />
      <entry key="rootSearchBase" value="dc=seri,dc=sailpointdemo,dc=com" />
    </Map>
  </Attributes>
  <Signature>
    <Inputs>
      <Argument name="expiringEmailTemplate" required="true"
        type="EmailTemplate"
        helpKey="Select the EmailTemplate to use for users with Expiring Passwords">
        <Prompt>Expiring Email Template</Prompt>

      </Argument>

      <Argument name="expiredEmailTemplate" type="EmailTemplate"
        helpKey="Select the EmailTemplate to use for users with Expired Passwords">
        <Prompt>Expired Email Template</Prompt>

      </Argument>

      <Argument name="appId" required="true" type="Application"
        helpKey="Select the Active Directory or Sun LDAP directory to scan for passwords">
        <Prompt>Application to Scan for expiring passwords</Prompt>

      </Argument>
      <Argument name="opendj" type="boolean"
        helpKey="If you selected an App of type Sun LDAP and you are actually going against OpenDS/OpenDJ, set this value to true">
        <Prompt>Is OpenDJ</Prompt>

      </Argument>
      <Argument name="range" required="true" type="string"
        helpKey="CSV list of days to notify users. \ne.g. 10,7,5,3,1 will notify users 10 days before expiration, 7 days before expiration, etc..">
        <Prompt>CSV List of Range</Prompt>
      </Argument>

      <Argument name="rootSearchBase" required="true" type="string"
        helpKey="Overrides the rootSearchBase that is derived from the selected Applications searchBase">
        <Prompt>rootSearchBase AD</Prompt>
      </Argument>

      <Argument name="accountNeverExpires" required="false"
        type="boolean"
        helpKey="Select to include users whose account never expires.  Not needed for SERI AD Resource Image.">
        <Prompt>Include Users whose account never expires</Prompt>
      </Argument>

      <Argument name="user" required="false" type="string"
        helpKey="Set if the default user for the Application selected above needs to be overriden">
        <Prompt>Override User</Prompt>
      </Argument>

      <Argument name="password" required="false" type="string"
        helpKey="Set if the default user for Application selected above needs to be overridden">
        <Prompt>Override Password</Prompt>
      </Argument>

      <Argument name="searchBase" required="false" type="string"
        helpKey="Overrides the searchBase that is derived from the selected Applications searchDN.  If partitioning is enabled then this value will need to be set since there will be multiple searchDNs">
        <Prompt>Override searchBase</Prompt>
      </Argument>

      <Argument name="testMode" required="false" type="boolean"
        helpKey="When true, this will process the Expired Users but NOT send any notifications">
        <Prompt>Enable Test Mode</Prompt>
      </Argument>

      <Argument name="expired" required="false" type="boolean"
        helpKey="Option to notify users that have passed their Password Expiration date">
        <Prompt>Notify Users of already Expired passwords</Prompt>
      </Argument>
    </Inputs>

    <Returns>
      <Argument name="pwdCount" type="String">
        <Prompt>Total Number of Users Notified of Expiring Passwords:</Prompt>
      </Argument>
      <Argument name="expiredCount" type="String">
        <Prompt>Total Number of Users Notified of Expired Passwords:</Prompt>
      </Argument>
      <Argument name="rangeCount" type="String">
        <Prompt>Total for Each Range:</Prompt>
      </Argument>
    </Returns>
  </Signature>
</TaskDefinition>